<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
    <script src="/js/jquery.min.js"></script>
    <h1>The Index Page</h1>
    <div>
        <button onclick="doGetLogs()">日志管理</button>
        <button>菜单管理</button>
        <button>XXXX</button>
        <button>XXXX</button>
    </div>
    <div id="container">
        <table>
            <thead>
            <tr>
                <th><input type="checkbox" id="checkAll"></th>
                <th>操作人员</th>
                <th>操作名称</th>
                <th>请求方法</th>
                <th>IP地址</th>
                <th>操作状态</th>
                <th>操作时间</th>
            </tr>
            </thead>
            <tbody id="tbody">
            <tr><td colspan="7">数据正在加载中.....</td></tr>
            </tbody>
        </table>
    </div>
    <script>
        function doGetLogs(){
            // debugger
            let url="http://localhost/log";
            $.ajax({
                url:url,
                success(result) {
                    console.log(result);
                    //$("#container").html(JSON.stringify(result))
                    //处理服务端响应结果
                    doHandleQueryResponseResult(result);
                }})
        }
        function doHandleQueryResponseResult(result){
            if(result.state==1){
                doHandleQueryOk(result);//处理正确的响应结果
            }else{
                //doHandleQueryError(result.message);//处理错误的响应结果
            }
        }
        function doHandleQueryOk(result){
            //初始化日志列表信息
            doInitLogListInfo(result.data.list);
            //初始化日志分页信息
            //doInitLogPageInfo(result.data);
        }
        function doInitLogListInfo(list){
            //1.获取tbody对象,并清空原有内容
            let tBody=$("#tbody");
            tBody.empty();
            //2.迭代list集合,追加新内容
            list.forEach((item)=>{
                tBody.append(doCreateRow(item));
            })
        }
        function doCreateRow(item){
            return `<tr>
                        <td><input type="checkbox" value="${item.id}"></td>
                        <td>${item.username}</td>
                        <td>${item.operation}</td>
                        <td>${item.method}</td>
                        <td>${item.ip}</td>
                        <td>${item.status?"成功":"失败"}</td>
                        <td>${new Date(item.createdTime).toLocaleString()}</td>
                    </tr>`
        }
    </script>
</body>
</html>